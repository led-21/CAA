<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="CAA.Views.HistoryPage"
    Title="Historico"
    BackgroundColor="{StaticResource Background}">

  <Grid RowDefinitions="Auto,*,Auto">
        
  <!-- Professional Header -->
   <StackLayout Grid.Row="0" Style="{StaticResource HeaderStyle}">
            <Label Text="Historico de Comunicacao" 
        Style="{StaticResource HeadlineMedium}"
      TextColor="{StaticResource TextOnPrimary}"
           HorizontalOptions="Center"/>
            <Label Text="Suas mensagens anteriores" 
      Style="{StaticResource BodyMedium}"
TextColor="{StaticResource TextOnPrimary}"
  Opacity="0.9"
     HorizontalOptions="Center"/>
     </StackLayout>

  <!-- Content Area -->
 <ScrollView Grid.Row="1">
    <StackLayout Padding="16" Spacing="16">
           
   <!-- History Items -->
     <CollectionView ItemsSource="{Binding HistoryCommunications}">
   <CollectionView.ItemsLayout>
        <LinearItemsLayout Orientation="Vertical" ItemSpacing="12"/>
    </CollectionView.ItemsLayout>
     <CollectionView.ItemTemplate>
           <DataTemplate>
         <Frame Style="{StaticResource CardElevated}">
        <Grid RowDefinitions="Auto,Auto,Auto" ColumnDefinitions="Auto,*" RowSpacing="8" ColumnSpacing="12">
   
    <!-- Icon -->
        <Frame Grid.Row="0" Grid.Column="0" Grid.RowSpan="2"
    BackgroundColor="{StaticResource Primary}"
     CornerRadius="12"
Padding="12"
        HasShadow="False"
   WidthRequest="48"
      HeightRequest="48">
        <Label Text="..." 
       FontSize="24"
       HorizontalOptions="Center"
 VerticalOptions="Center"/>
   </Frame>

   <!-- Message -->
       <Label Grid.Row="0" Grid.Column="1"
    Text="{Binding FinalPhrase}" 
      Style="{StaticResource BodyLarge}"
    MaxLines="3"
      LineBreakMode="TailTruncation"/>
   
     <!-- Timestamp -->
     <Label Grid.Row="1" Grid.Column="1"
       Text="{Binding Timestamp, StringFormat='{0:dd/MM/yyyy HH:mm:ss}'}" 
        Style="{StaticResource BodySmall}"/>

    <!-- Separator -->
         <BoxView Grid.Row="2" Grid.ColumnSpan="2"
   Color="{StaticResource Gray200}"
                 HeightRequest="1"
Margin="0,8,0,0"/>
     
     </Grid>
        </Frame>
  </DataTemplate>
</CollectionView.ItemTemplate>
      <CollectionView.EmptyView>
        <StackLayout VerticalOptions="CenterAndExpand" 
        HorizontalOptions="Center"
        Padding="40"
      Spacing="16">
          <Frame BackgroundColor="{StaticResource Gray100}"
     BorderColor="Transparent"
        CornerRadius="100"
 Padding="30"
         HasShadow="False"
       HorizontalOptions="Center">
     <Label Text="..." 
           FontSize="64"
     HorizontalOptions="Center"/>
        </Frame>
           <Label Text="Nenhuma comunicacao registrada" 
      Style="{StaticResource HeadlineMedium}"
      HorizontalOptions="Center"
     HorizontalTextAlignment="Center"/>
<Label Text="As mensagens que voce criar aparecerao aqui" 
        Style="{StaticResource BodyMedium}"
       TextColor="{StaticResource TextSecondary}"
 HorizontalOptions="Center"
           HorizontalTextAlignment="Center"/>
      </StackLayout>
     </CollectionView.EmptyView>
   </CollectionView>

    <!-- Bottom Spacing -->
      <BoxView HeightRequest="20" Color="Transparent"/>

   </StackLayout>
        </ScrollView>

   <!-- Action Button -->
    <Grid Grid.Row="2" 
         Padding="16"
          BackgroundColor="{StaticResource Surface}">
            
    <!-- Shadow Effect -->
         <BoxView Color="{StaticResource Gray200}"
     HeightRequest="1"
      VerticalOptions="Start"
      Margin="0,-1,0,0"/>

   <Button Text="Voltar para Comunicacao"
    Command="{Binding GoBackCommand}"
     Style="{StaticResource ButtonPrimary}"/>
  </Grid>

    </Grid>
</ContentPage>
